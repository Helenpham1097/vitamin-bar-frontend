<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Get From User</title>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js">

    </script>
</head>
<body>
<div id="demo1">
    <button type="button" id="demo_menu" onclick="getAllMenu()">Get All Menu</button>
</div>
<div id="demo2">
    <button type="button" onclick="getListItemsByBeverageType('Juice')">Get List Items Of A Beverage Type</button>
</div>
<div id="demo3">
    <button type="button" onclick="getItemByName('Peanut Coconut Smoothie')">Get Item</button>
</div>
<div id="demo4">
    <button type="button" onclick="createNewBeverage()">Create new beverage</button>
</div>
<div id="demo5">
    <button type="button" onclick="updateTypeInformationName()">Update Beverage</button>
</div>
<div id="demo6">
    <button type="button" onclick="updateItemInformation()">Update Item Information</button>
</div>
<div id="demo7">
    <button type="button" onclick="deleteAnItem('Pomegranate Juice')">Delete Item</button>
</div>
<div id="demo8">
    <button type="button" onclick="deleteBeverageTypeAndListItems('Protein Shake')">Delete All Of Beverage</button>
</div>
<!--<input type="button" id="ajaxPost" value="Add new employee"/>-->
<!--<br>-->
<!--<input type="button" id="ajaxGet" value="Get employee"/>-->
<!--<input type="button" id="demo10" value="Get employee by jQuery"/>-->
<!--<p id="demo11"></p>-->

<script>

    function getAllMenu() {
        const xHttp = new XMLHttpRequest();
        xHttp.onload = function () {
            const menus = JSON.parse(this.responseText);
            let text = "";
            for (let i = 0; i < menus.length; i++) {
                let menu = menus[i];
                text += menu["typeName"] + "<br>";
                const details = menu.details;
                for (let j = 0; j < details.length; j++) {
                    const detail = details[j];
                    text += "<ul>";
                    for (const x in detail) {
                        text += "<li>" + x + ": " + detail[x] + "</li>";
                    }
                    text += "</ul>";
                }
            }
            document.getElementById("demo1").innerHTML = text;
        }
        xHttp.open("GET", "http://localhost:8080/vitamin-bar");
        xHttp.send();
    }

    function getListItemsByBeverageType(beverageType){
        const xHttp = new XMLHttpRequest();
        xHttp.onload = function () {
            const listItems = JSON.parse(this.responseText);
            let printedItems = "";
            for(let i = 0; i< listItems.length; i++){
                const item = listItems[i];
                for(const x in item){
                    printedItems += x +": "+  item[x];
                }
            }
            document.getElementById("demo2").innerText = printedItems;
        }
        xHttp.open("GET", "http://localhost:8080/vitamin-bar/get-details/"+beverageType);
        xHttp.send();
    }

    function getItemByName(name) {
        const xHttp = new XMLHttpRequest();
        xHttp.onload = function () {
            const beverage = JSON.parse(this.responseText);
            let text = "";
            for (const x in beverage) {
                text += beverage[x] + ", " + "<br>";
            }
            document.getElementById("demo3").innerHTML = text;
        }
        xHttp.open("GET", "http://localhost:8080/vitamin-bar/" + name, true);
        xHttp.send();
    }

    function createNewBeverage() {
        const xHttp = new XMLHttpRequest();
        xHttp.open("POST", "http://localhost:8080/vitamin-bar/add", true);
        xHttp.setRequestHeader("Accept", "application/json");
        xHttp.setRequestHeader("Content-type", "application/json");
        xHttp.onreadystatechange = function () {
            if (xHttp.readyState === 4) {
                console.log(xHttp.responseText);
            }
        }
        const newBeverage = '{\n' +
            '  "typeName" : "Protein Shake",\n' +
            '  "list": [{\n' +
            '    "itemCode": "P1",\n' +
            '\t"name": "Chocolate Milk Protein Shake",\n' +
            '\t"price": 50000\n' +
            '  }\n' +
            '  ]\n' +
            '}'
        xHttp.send(newBeverage);
    }

    function updateTypeInformationName() {
        const xHttp = new XMLHttpRequest();
        xHttp.open(
            "PUT", "http://localhost:8080/vitamin-bar/update-main-beverage-name");
        xHttp.setRequestHeader("Content-type", "application/json");
        xHttp.onreadystatechange = function () {
            if (xHttp.readyState === 4) {
                console.log(xHttp.responseText);
            }
        }
        const updatedData = '{"typeName": "Mango Smoothie", "newTypeName": "Lychee Smoothie"}';
        xHttp.send(updatedData);
    }

    function updateItemInformation(){
        const  xHttp = new XMLHttpRequest();
        xHttp.open("PUT", "http://localhost:8080/vitamin-bar/update-item-information");
        xHttp.setRequestHeader("Content-type", "application/json");
        xHttp.onreadystatechange = function () {
            if(xHttp.readyState === 4){
                alert(xHttp.responseText);
            }
        }
        const itemUpdate = '{"name": "Coconut Juice", "item":{ "itemCode": "J4", "name": "Pomegranate Juice", "price": 28000}}';
        xHttp.send(itemUpdate);
    }

    function deleteAnItem(name){
        const xHttp = new XMLHttpRequest();
        xHttp.open("DELETE", "http://localhost:8080/vitamin-bar/delete-item/"+name);
        xHttp.onreadystatechange = function () {
            if(xHttp.readyState === 4){
                alert(xHttp.responseText);
            }
        }
        xHttp.send();
    }

    function deleteBeverageTypeAndListItems(name){
        const xHttp = new XMLHttpRequest();
        xHttp.open("DELETE", "http://localhost:8080/vitamin-bar/delete-all/"+name);
        xHttp.onreadystatechange = function () {
            if(xHttp.readyState === 4){
                alert(xHttp.responseText);
            }
        }
        xHttp.send();
    }
    //CREATE NEW EMPLOYEE USING AJAX
    $(document).ready(function () {
        // $('#ajaxPost').click(purchaseClicked);
        $('#ajaxPost').click(function () {
            $.post("https://reqres.in/api/users/",
                {
                    data: {
                        name: "Trang",
                        jpb: "Helen"
                    },
                    // success: function(response){
                    //     console.log(response);}
                    function(status) {
                        alert("Status: " + status);

                    },
                });
        });
    });
    $(document).ready(function () {
        $('#ajaxGet').click(function () {
            $.get("https://reqres.in/api/users/2",
                function (Data) {
                    let text = "";
                    for (const x in Data) {
                        for (const y in Data[x]) {
                            text += Data[x][y]
                        }
                    }
                    document.getElementById("demo7").innerText = text;
                });
        });
    });
</script>
</body>
</html>

</html>